/*! child-tracker-loader.js - v2.0.0 - 2016-11-05 */
!function(a,b){var c=function(a){return a?a.autoInit():null},d=function(a){0!==this.el.getElementsByTagName("iframe").length&&this.sendMessage("on-screen",a)},e=function(){var a=window.innerHeight||document.documentElement.clientHeight;0!==this.el.getElementsByTagName("iframe").length&&this.sendMessage("viewport-height",a)},f=function(){var a=location.hash;0!==this.el.getElementsByTagName("iframe").length&&this.sendMessage("visibility-available",a)},g=function(a){this.trackers[a].stopTracking(),delete this.trackers[a]},h=function(a){a=+a;var b=/\((\d+)\)(.*)/.exec(document.title);if(b){var c=+b[1];c=a?c+a:a,document.title=c>0?"("+c+")"+b[2]:b[2].trim()}else a>0&&(document.title="("+a+") "+document.title)},i=function(a,b){var c={};if(a){var e=new a.VisibilityTracker(this,b,d.bind(this,b),c);this.trackers[b]=e}else{var f=new window.ChildTracker.VisibilityTracker(this,b,d.bind(this,b),c);this.trackers[b]=f}},j=function(a,b){for(var c=0;c<a.length;c++)!function(c){var d=a[c];d.trackers={},d.onMessage("test-visibility-tracker",f),d.onMessage("remove-tracker",g),d.onMessage("request-tracking",i.bind(d,b)),d.onMessage("get-viewport-height",e),d.onMessage("update-parent-title",h),window.addEventListener("resize",e.bind(d))}(c)},k=function(b,d){if("undefined"!=typeof a){b=b.split(".js")[0],d=d.split(".js")[0];var e="context_debates_"+b.split("/").slice(-1)[0],f=a.config({context:e,paths:{pym:b,tracker:d},shim:{pym:{exports:"pym"},tracker:{exports:"tracker"}}});return f(["require","pym","tracker"],function(a,b,d){var e=c(b);e?j(e,d):console.error("did not find any pym instance on autoInit")}),!0}return!1},l=function(a,d){return"undefined"!=typeof b&&"function"==typeof b.getScript&&(b.getScript(a).done(function(){var a=c(window.pym);b.getScript(d).done(function(){j(a)})}),!0)},m=function(a,b){var d=document.getElementsByTagName("head")[0],e=document.createElement("script");return e.type="text/javascript",e.src=a,e.onload=function(){d&&e.parentNode&&d.removeChild(e);var a=c(window.pym);d=document.getElementsByTagName("head")[0];var f=document.createElement("script");f.type="text/javascript",f.src=b,f.onload=function(){d&&e.parentNode&&d.removeChild(e),j(a)},d.appendChild(f)},d.appendChild(e),!0},n="//pym.nprapps.org/pym.v1.min.js";0===n.lastIndexOf("@@",0)&&(n="../../src/pym.js");var o="//carebot.nprapps.org/child-tracker.v2.min.js";0===o.lastIndexOf("@@",0)&&(o="../../src/child-tracker.js"),k(n,o)||l(n,o)||m(n,o);var p=function(){document.removeEventListener("DOMContentLoaded",p),window.removeEventListener("load",p);var a=c(window.pym);return a&&"undefined"!=typeof ChildTracker&&j(a),a};window.document.addEventListener("DOMContentLoaded",p),window.addEventListener("load",p)}(window.requirejs,window.jQuery);