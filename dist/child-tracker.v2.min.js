/*! child-tracker.js - v2.0.0 - 2016-11-05 */
!function(a){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&module.exports?module.exports=a():window.ChildTracker=a.call(this)}(function(){function a(a,b,d){var e,f,g,h=null,i=0;d||(d={});var j=function(){i=d.leading===!1?0:c(),h=null,g=a.apply(e,f),h||(e=f=null)};return function(){var k=c();i||d.leading!==!1||(i=k);var l=b-(k-i);return e=this,f=arguments,l<=0||l>b?(h&&(clearTimeout(h),h=null),i=k,g=a.apply(e,f),h||(e=f=null)):h||d.trailing===!1||(h=setTimeout(j,l)),g}}var b={},c=Date.now||function(){return(new Date).getTime()},d=function(a,b){function c(){a&&b&&(e=setTimeout(a,b))}function d(){clearTimeout(e)}var e;return{start:c,stop:d}};return b.VisibilityTracker=function(b,c,e,f){function g(a){var b=a.split(" "),c={top:parseFloat(b[0]),left:parseFloat(b[1]),bottom:parseFloat(b[2]),right:parseFloat(b[3])};return c}function h(a,c){var d=b.iframe.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,f=window.innerHeight||document.documentElement.clientHeight;return!!(c&&d.top<=f-a.top&&d.top>=-a.bottom&&d.left<=e-a.left&&d.left>=-a.right)||d.top<=f-a.bottom&&d.top>=-a.top&&d.left<=e-a.right&&d.left>=-a.left}function i(a){var c=h(a,this.settings.ALLOW_PARTIAL);return this.isVisible&&!c&&k.stop(),!this.isVisible&&c&&(k.start(),0!==b.el.getElementsByTagName("iframe").length&&b.sendMessage("element-visible",this.id)),this.isVisible=c,this.rect=a,this.isVisible}this.settings={WAIT_TO_ENSURE_SCROLLING_IS_DONE:400,WAIT_TO_MARK_READ:500,ANIMATION_DURATION:800,ALLOW_PARTIAL:!0},this.id=c,this.isVisible=!1;for(var j in f)this.settings[j]=f[j];var k=new d(e,this.settings.WAIT_TO_MARK_READ);f=f||{};var l=function(){0!==b.el.getElementsByTagName("iframe").length&&b.sendMessage("request-bounding-client-rect",this.id)},m=a(l.bind(this),this.settings.WAIT_TO_ENSURE_SCROLLING_IS_DONE);return this.stopTracking=function(){window.removeEventListener&&(removeEventListener("DOMContentLoaded",m,!1),removeEventListener("load",m,!1),removeEventListener("scroll",m,!1),removeEventListener("resize",m,!1)),delete b.messageHandlers[this.id+"-bounding-client-rect-return"]},window.addEventListener&&(addEventListener("DOMContentLoaded",m,!1),addEventListener("load",m,!1),addEventListener("scroll",m,!1),addEventListener("resize",m,!1)),b.onMessage(this.id+"-bounding-client-rect-return",function(a){var b=g(a);i.call(this,b)}.bind(this)),l.call(this),this},b});